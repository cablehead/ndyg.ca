{% macro optional_link(url) %} {% if url %}
<a href="{{ url }}">{{ caller() }}</a>
{% else %}{{ caller() }}{% endif %} {% endmacro %}

<div class="planting">
  <style>
    em.status {
      font-size: 0.8rem;
      border-radius: 0.4em;
      display: inline-block;
      padding: 0.1em 0.4em;
      border: 1px dotted var(--shadow-color);
      white-space: nowrap;
    }

    .planting {
      display: flex;
      flex-direction: column;
      gap: 2em;
    }

    .sub-planting {
      display: flex;
      align-items: stretch;
      gap: 1em;
    }

    .sub-planting > :nth-child(1) {
      align-self: stretch;
      flex: 2;
    }

    .sub-planting > :nth-child(2) {
      align-self: stretch;
      flex: 3;
    }
  </style>
  <div style="display: flex; flex-direction: column; gap: 1em">
    <div>
      {% call optional_link(planting.url) %}{{ planting.name }}{% endcall %}
      <em>Status: {{ planting.status | safe }}</em>
      {{ planting.description | safe }} {% if planting.image %}{% call optional_link(planting.url)
			%}<p><img src="./{{ planting.image.path }}" />{% endcall %}</p>{% endif %}
    </div>

    {% for planting in planting.sub %}
    <div class="sub-planting">
      <div>
        {% if planting.image %}{% call optional_link(planting.url) %}
        <img
          style="object-position: top left; object-fit: cover; width: 100%; height: 100%"
          src="{{ planting.image.path }}"
        />
        {% endcall %} {% endif %}
      </div>
      <div>
        {% call optional_link(planting.url) %}{{ planting.name }}{% endcall %}
        <em>Status: {{ planting.status | safe }}</em>
        {{ planting.description | safe }}
      </div>
    </div>
    {% endfor %}
  </div>
</div>
